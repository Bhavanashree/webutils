<directives>
	<directive name="ykField">
		<content>
			<set-var name="_idAttr" expr="context.attributes.id ? context.attributes.id : ''"/>
			<set-var name="_typeAttr" expr="context.attributes.type ? context.attributes.type : ''"/>
			<set-var name="_modelAttr" expr="context.attributes.model ? context.attributes.model : ''"/>
			<set-var name="_nameAttr" expr="context.attributes.name ? context.attributes.name : (context.attributes.model ? context.attributes.model : '')"/>
			
			<div class="form-group">
				<label for="${_nameAttr}" class="col-md-4 control-label">${attributes.label}</label>
				<div class="col-md-8" style="padding-left: 0.5em;">
					<input type="${_typeAttr}" class="form-control" 
						id="${_idAttr}" name="${_nameAttr}" 
						placeholder="${attributes.label}" ng-model="${_modelAttr}"/>
				</div>
			</div>
		</content>
	</directive>
	
	<directive name="ykImageSlider" required-attr="id, dataattr, width, height">
		<content>
			<set-var name="_idAttr" expr="context.attributes.id"/>
			<set-var name="_dataAttr" expr="context.attributes.dataattr"/>

			<div class="container" style="width: ${attributes.width};height: ${attributes.height};">
				<br/>
				<div id="${_idAttr}" class="carousel slide" data-ride="carousel">
					<!-- Indicators -->
					<ol class="carousel-indicators">
						<li data-target="#myCarousel" ng-repeat="slideImage in ${_dataAttr}" data-slide-to="{{$index}}" class="{{$first ? 'active' : ''}}"></li>
					</ol>
			
					<!-- Wrapper for slides -->
					<div class="carousel-inner" role="listbox">

						<div ng-repeat="slideImage in ${_dataAttr}" class="item {{$first ? 'active' : ''}}">
							<img src="{{slideImage.imagePath}}" style="height: ${attributes.height}"/>
							<div class="carousel-caption" ng-bind-html="slideImage.caption">
						    </div>
						</div>
					</div>
			
					<!-- Left and right controls -->
					<a class="left carousel-control" href="#${_idAttr}" role="button" data-slide="prev" style="width: 2em;"> 
						<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> 
						<span class="sr-only">Previous</span>
					</a> 
					<a class="right carousel-control" href="#${_idAttr}" role="button" data-slide="next" style="width: 2em;"> 
						<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
						<span class="sr-only">Next</span>
					</a>
				</div>
			</div>
		</content>
	</directive>
	
	<directive name="ykDropDown" required-attr="id, icon">
		<content>
			<set-var name="_label" expr="context.flexAttr('label')"/>
			<set-var name="_header" expr="context.flexAttr('header')"/>
			<set-var name="_footer" expr="context.flexAttr('footer')"/>
			<set-var name="_content" expr="context.element.find('content').html()"/>
			
			<div class="dropdown" style="display: inline;">
				<a id="${attributes.id}" style="text-decoration: none;" data-target="#" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
					<i class="glyphicon appIcon ${attributes.icon}" style="color: ${attr('icon-color','')};font-weight: bold;" aria-hidden="true"></i>
					${_label}
				</a>
				
				<div id="${attributes.id}-dropdown" class="dropdown-menu dropdown-menu-right" aria-labelledby="${attributes.id}">
					<if test="context._header.length > 0">
						<div class="yk-dropdown-header">
							${_header}
						</div>
					</if>
					${_content}
					<if test="context._footer.length > 0">
						<div class="yk-dropdown-footer">
							${_footer}
						</div>
					</if>
				</div>
			</div>

		</content>
	</directive>

	<directive name="ykTabs">

		<content>
			<set-var name="_tabs" expr="context.element.find('tab')"/>
			
			<set-var name="_footer" expr="context.flexAttr('footer')"/>
			<set-var name="_content" expr="context.element.find('content').html()"/>
			
			<div>
				<!-- Nav tabs -->
				<ul class="nav nav-tabs" role="tablist">
					<for-each data="${_tabs}" loop-var="tab" index-var="tabIdx">
						<set-var name="_tab" expr="$(context.tab)"/>
						<set-var name="_tabId" expr="context._tab.attr('id')"/>
						<set-var name="_tabActive" expr="context.tabIdx == 0 ? 'active' : ''"/>
						
						<li role="presentation" class="${_tabActive}">
							<a id="${_tabId}_tab" ui-sref="${_tab.attr('state')}" href="#${_tabId}" onfocus="blur()" data-target="#${_tabId}" data-toggle="tab">
								<if test="context.attr('icon', null, context._tab)">
									<i class="glyphicon appIcon ${_tab.attr('icon')}" style="color: ${attr('icon-color', '', context._tab)};font-weight: bold;" aria-hidden="true"></i>
								</if>
								${_tab.attr('label')}
							</a>
						</li>
					</for-each>
				</ul>
			
				<!-- Tab panes -->
				<div class="tab-content">
					<for-each data="${_tabs}" loop-var="tab" index-var="tabIdx">
						<set-var name="_tab" expr="$(context.tab)"/>
						<set-var name="_tabActive" expr="context.tabIdx == 0 ? 'active' : ''"/>
						<set-var name="_tabContent" expr="context._tab.html()"/>
						
						<div role="tabpanel" class="tab-pane ${_tabActive}" id="${_tab.attr('id')}" ui-view="${_tab.attr('view')}" style="padding: 0.5em;">
							${_tabContent}
						</div>

					</for-each>
				</div>
			</div>
		</content>
	</directive>


	<directive name="ykNavTree">
		<content>
			<exe-script>
				context.executeTemplate({
					"parent" : context.element
				}, "processTreeItems");
			</exe-script>
		</content>
	</directive>
	
	<template name="processTreeItems">
		<set-var name="_items" expr="context.parent.children('tree-item')"/>
		
		<if test="context._items.length &lt;= 0">
			<return/>
		</if>
		
		<ul class="yk-nav-list">
			<for-each data="${_items}" loop-var="item" index-var="itemIdx">
				<set-var name="_item" expr="$(context.item)"/>
				
				<li role="presentation">
					<a id="${_item.attr('id')}" ui-sref="${_item.attr('state')}">
						${_item.attr('label')}
					</a>
		
					<exe-script>
						context.executeTemplate({
							"parent" : context._item
						}, "processTreeItems");
					</exe-script>
				</li>
			</for-each>
		</ul>
	</template>

	<directive name="ykSearchQuery" required-attr="id, name, title">
		<content>
			<exe-script var="_tmp">
				var response = null;
				var name = context.attr("name");
				try
				{
					response = context.invokeAction("search.fetch.queryDef", null, {"name" : name});
				}catch(ex)
				{
					console.error("Invalid search query name specified - " + name);
					console.error(ex);
					
					throw "Invalid search query name specified - " + name;
				}
				
				if(!response.modelDef)
				{
					console.error("Failed to fetch search query def from server - " + name);
					throw "Invalid search query name specified - " + name;
				}

				context["searchModel"] = response.modelDef;
				
				//caluculate the size for label and field in the search query ui
				var labelSize = 0, fldLblLength = 0;
				var modelDef = response.modelDef;

				modelDef.fieldMap = {};
				modelDef.extensionFieldMap = {};

				
				for(var i = 0; i &lt; modelDef.fields.length; i++)
				{
					fldLblLength = $.fontWidth('bold 14px "Times New Roman", Times, serif', modelDef.fields[i].label + "MMM");
					labelSize = (labelSize &gt; fldLblLength) ? labelSize : fldLblLength;

					modelDef.fieldMap[ modelDef.fields[i].name ] = modelDef.fields[i];
				}
				
				context["labelSize"] = labelSize;
				context["fieldWidth"] = 15;
				////////////////////////
				
				//set the actions on context
				var actions = context.element.children("action");
				
				if(actions.length &gt; 0)
				{
					context["actions"] = context.element.children("action");
				}
				else
				{
					context["actions"] = null;
				}

				//Add model and model-def to scope
				context["$scope"].modelDef = modelDef;
				
				if(!context["$scope"].model)
				{
					context["$scope"].model = {};
				}
			</exe-script>
			
			<set-var name="_showQuery" expr=" (context.attr('hide-query') == 'true') ? false : true"/>
			
			<div id="${attr('id')}" class="container-fluid" style="padding: 0px; margin: 0px" ng-controller="searchQueryController" yk-model-def="${searchModel.name}">
			
				<span style="display: none;" ng-init="searchQueryId = '${attr('id')}'; searchQueryName = '${attr('name')}';"></span>
				
				<if test="context._showQuery">
					<div class="panel panel-default" style="margin-bottom: 0.4em;">
						<div class="panel-heading" style="padding: 0.3em 1em; font-weight: bold;">
							${attr('title')}
						</div>
		
						<div class="panel-body model-form" style="padding: 0px;">
							<form>
								<div style="width: 100%; padding: 0px;">
									<for-each data="${searchModel.fields}" loop-var="field" index-var="idx">
										<yk-model-field name="${field.name}" modelobj="searchQuery" 
												label-width="${labelSize}px" field-width="${fieldWidth}em" full-width="" 
												element-style="margin: 1em; margin-bottom: 0px;"></yk-model-field>
									</for-each>
								</div>
								
								<div class="row" style="text-align: right; padding-right: 2em;">
									<!-- Submit button is added to support enter key in search form. This will be hidden.
										Instead iconic link button will be used for click 
									 -->
									<input type="submit" value="Search" style="display: none;" ng-click="performSearch($event)"/>
									
									<a class="btn btn-primary" role="button" ng-click="performSearch($event)" style="margin: 0.5em; margin-right: 0px;">
										<i class="glyphicon glyphicon-search"></i>
										Search
									</a>
								</div>
							</form>
						</div>
					</div>
				</if>
				
				<div class="row">
					<if test="context.actions">
						<div class="col-xs-12" style="text-align: right; padding-bottom: 0.4em;">
							<for-each data="${actions}" loop-var="action" index-var="actionIdx">
								<set-var name="_action" expr="$(context.action)"/>
								<set-var name="_label" expr="context._action.attr('label') ? context._action.attr('label') : ''"/>
								
								<a role="button" ng-click="${_action.attr('method')}" style="text-decoration: none; color: ${_action.attr('color')};" class="yk-icon-link" 
											data-toggle="tooltip" title="${_action.attr('label')}">
									<i class="glyphicon ${_action.attr('icon')}"></i>
								</a>
							</for-each>
						</div>
					</if>
				</div>
	
				<div class="panel panel-default">
					<div class="panel-heading" style="padding: 0.3em 1em; font-weight: bold;">
						${attr('title')} - Results
					</div>
	
					<div class="panel-body table-responsive"  yk-model="${searchModel.name}" style="padding: 0px;">
						<table class="table table-striped table-bordered table-hover searchResults" ng-if="searchResults.length &gt; 0">
							<!-- Headings row -->
							<tr>
								<th>#</th>
								<th ng-repeat="field in searchResultDef.fields" ng-if="field.displayable">
									{{field.label}}
								</th>
							</tr>
							
							<tr ng-repeat="result in searchResults" ng-click="rowSelected($index)" search-row-id="{{$index}}" style="cursor: pointer;">
								<td>{{$index + 1}}</td>
								<td ng-repeat="field in searchResultDef.fields" ng-if="field.displayable">
									{{result[field.name]}}
								</td>
							</tr>
						</table>
						
						<div ng-if="searchResults.length &lt;= 0" style="margin: 0.5em;">No records found for specified criteria.</div>
					</div>
				</div>
			</div>
		</content>
		
		<pre-compile-script>
			context.$result.data('model-def', context.$scope.modelDef);
		</pre-compile-script>
		
		<post-script>
			context.validator.customizeUi(context.$result, context.$scope.modelDef);
		</post-script>
	</directive>

	<directive name="ykDialog" required-attr="id, title">
		<content>
			<set-var name="_size" expr="(context.attr('size') == 'small') ? 'modal-sm' : 'modal-lg'"/>
			<set-var name="_content" expr="context.element.find('content').html()"/>
			<set-var name="_footer" expr="context.element.find('footer').html()"/>
			
			<div class="modal fade" id="${attr('id')}" tabindex="-1" role="dialog" data-backdrop="static">
				<div class="modal-dialog ${_size}" role="document">
					<div class="modal-content">
						<if test="context.attr('hide-header') != 'true'">
							<!-- Header -->
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">&amp;times;</span>
								</button>
								<h4 class="modal-title">${attr('title')}</h4>
							</div>
						</if>
						
						<!-- Content -->
						<div class="modal-body">
							${_content}
						</div>
						
						<!-- Footer -->
						<div class="modal-footer">
							${_footer}
						</div>
					</div>
				</div>
			</div>

		</content>
	</directive>

	<directive name="ykModelDialog" required-attr="id, name, columns, title, actionmethod">
		<content>
			<exe-script var="_tmp">
				var extraHtml = context.element.find("extra-content");
				
				if(extraHtml &amp;&amp; extraHtml.length &gt; 0)
				{
					extraHtml = $(extraHtml.get(0)).html();
				}
				else
				{
					extraHtml = "";
				}
				
				context["extraHtml"] = extraHtml; 
				
				context["modelObj"] = context.attr("modelObj") ? context.attr("modelObj") : "model"; 
			</exe-script>
		
			<set-var name="_size" expr="(context.attr('size') == 'small') ? 'modal-sm' : 'modal-lg'"/>
			
			<div class="modal fade" id="${attr('id')}" tabindex="-1" role="dialog" data-backdrop="static">
				<div class="modal-dialog ${_size}" role="document">
					<div class="modal-content">
						<!-- Header -->
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&amp;times;</span>
							</button>
							<h4 class="modal-title">${attr('title')}</h4>
						</div>
						
						<!-- Content -->
						<div class="modal-body" yk-model="${attr('name')}">
							<yk-model-form name="${attr('name')}" columns="${attr('columns')}" modelObj="${modelObj}"></yk-model-form>
							${extraHtml}
						</div>
						
						<!-- Footer -->
						<div class="modal-footer">
							<button type="button" class="btn btn-primary action-button" ng-click="${attr('actionMethod')}">{{newModelMode ? 'Save' : 'Update'}}</button>
							<button type="button" class="btn btn-danger cancel-button" data-dismiss="modal">Cancel</button>
						</div>
					</div>
				</div>
			</div>

		</content>
	</directive>

	<directive name="ykModelForm" required-attr="name, columns">
		<content>
			<exe-script var="_tmp">
				var modelName = context.attr('name');
				var modelDefResponse = context.invokeAction('modelDef.fetch', null, {"name": modelName});
				
				if(!modelDefResponse || !modelDefResponse.modelDef)
				{
					throw "Invalid model name specified - " + modelName;
				}
	
				var modelDef = modelDefResponse.modelDef;
				context["modelDef"] = modelDef;
				context["extensionFields"] = [];
	
				modelDef.fieldMap = {};
				modelDef.extensionFieldMap = {};
				
				//caluculate the size for label and field in the search query ui
				var labelSize = 0, fldLblLength = 0;
				
				for(var i = 0; i &lt; modelDef.fields.length; i++)
				{
					fldLblLength = $.fontWidth('bold 14px "Times New Roman", Times, serif', modelDef.fields[i].label + "MMM");
					labelSize = (labelSize &gt; fldLblLength) ? labelSize : fldLblLength;
					
					modelDef.fieldMap[ modelDef.fields[i].name ] = modelDef.fields[i];
				}
				
				//if model is extendable, fetch extension field details
				if(modelDef.extensionName)
				{
					var extensionFldRes = context.invokeAction('extensions.fetch', null, {"name": modelDef.extensionName});
					
					if(extensionFldRes &amp;&amp; extensionFldRes.extensionFields &amp;&amp; extensionFldRes.extensionFields.length &gt; 0)
					{
						context["extensionFields"] = extensionFldRes.extensionFields;
					}

					for(var i = 0; i &lt; extensionFldRes.extensionFields.length; i++)
					{
						fldLblLength = $.fontWidth('bold 14px "Times New Roman", Times, serif', extensionFldRes.extensionFields[i].label + "MMM");
						labelSize = (labelSize &gt; fldLblLength) ? labelSize : fldLblLength;

						extensionFldRes.extensionFields[i].fieldType = extensionFldRes.extensionFields[i].type;
						modelDef.extensionFieldMap[ extensionFldRes.extensionFields[i].name ] = extensionFldRes.extensionFields[i];
					}
				}
				
				context["labelSize"] = labelSize;

				var columnCount = parseInt(context.attr('columns'));
				columnCount = (columnCount &gt; 3) ? 3 : columnCount;
				columnCount = (columnCount &lt; 1) ? 1 : columnCount;
				
				context["fullWidth"] = (95 / columnCount);
				context["columnCount"] = columnCount;

				context["colIndex"] = 0;
				context["extColIndex"] = 0;

				//Add model and model-def to scope
				context["$scope"].modelDef = modelDef;
				
				if(!context["$scope"].model)
				{
					context["$scope"].model = {};
				}
				
				context["modelObj"] = context.attr("modelObj") ? context.attr("modelObj") : "model"; 
			</exe-script>
			
			<div class="container-fluid model-form" yk-model-def="${modelDef.name}">
				<div style="width: 100%;">
					<for-each data="${modelDef.fields}" loop-var="field" index-var="idx">
						<if test="!context.field.displayable">
							<continue/>
						</if>
					
						<if test="context.colIndex != 0 &amp;&amp; (context.colIndex % context.columnCount) == 0"><![CDATA[
							</div>
							<div style="${enclosingDivStyle}">
						]]></if>
						
						<yk-model-field name="${field.name}" modelobj="${modelObj}" label-width="${labelSize}px" 
							field-width="100%" full-width="${fullWidth}%" 
							element-style="margin: 0px; margin-left: 1em; margin-top: 1em;"></yk-model-field>
						
						<exe-script var="_tmp">
							context["colIndex"]++;
						</exe-script>
						
					</for-each>
				</div>							
				<div class="row">
					<for-each data="${extensionFields}" loop-var="field" index-var="idx">
						<if test="context.extColIndex != 0 &amp;&amp; (context.extColIndex % context.columnCount) == 0"><![CDATA[
							</div>
							<div style="width: 100%;">
						]]></if>
						
						<yk-model-field name="${field.name}" modelobj="${modelObj}.extendedFields" label-width="${labelSize}px" 
							field-width="100%" full-width="${fullWidth}%"
							element-style="margin: 0px; margin-left: 1em; margin-top: 1em;" extended="true"></yk-model-field>

						<exe-script var="_tmp">
							context["extColIndex"]++;
						</exe-script>
					</for-each>
				</div>							
			</div>
		</content>

		<pre-compile-script>
			context.$result.data('model-def', context.$scope.modelDef);
		</pre-compile-script>
		
		<post-script>
			context.validator.customizeUi(context.$result, context.$scope.modelDef);
		</post-script>
	</directive>

	<attr-directive name="ykModelDef">
		<script>
			if(!context.$scope.modelDef)
			{
				var modelDef = context.element.data('model-def');
				context.$scope.modelDef = modelDef;
				context.$scope.model = {};
			}
		</script>
	</attr-directive>

	<directive name="ykModelField" required-attr="name">
		<content>
			<exe-script var="_tmp">
				var modelDef =  context.actualElement.closest('[yk-model-def]').data('model-def');
				var name = context.attr('name');
				var extended = (context.attr('extended') == "true");
				
				if(!modelDef)
				{
					debugger;
					throw "No model-def is defined for yk-model-field with name - " + name;
				}
				
				var fieldDef = extended ? modelDef.extensionFieldMap[name] : modelDef.fieldMap[name];
				
				if(!fieldDef)
				{
					throw "Invalid field name specified under yk-model-field. No field with name '" + name + "' exists under model - " + modelDef.name;
				}
				
				var modelPrefix = context.attr('modelobj');
				
				if(modelPrefix &amp;&amp; modelPrefix.length &gt; 0)
				{
					context["modelField"] = modelPrefix + "." + name;
				}
				else
				{
					context["modelField"] = name;
				}
				
				context["fieldName"] = name;
				
				if(extended)
				{
					context["extended"] = "true";
					context["validateFunc"] = "validateExtendedField('" + name + "', '" + modelPrefix + "')";
					context["fieldLabel"] = "%" + fieldDef.name;
				}
				else
				{
					context["validateFunc"] = "validateField('" + name + "', '" + modelPrefix + "')";
					context["fieldLabel"] = fieldDef.name;
				}
				
				context["fieldDef"] = fieldDef;
				context["modelDef"] = modelDef;
			</exe-script>
			
			<div style="display: inline-block; vertical-align: top; width: ${element.attr('full-width')}; ${element.attr('element-style')}">
				<table style="width: 100%;border-collapse: collapse;border-spacing: 0px;">
					<tr>
						<td style="vertical-align: top; padding: 0px; width: ${element.attr('label-width')}; min-width: ${element.attr('label-width')}; " 
								yk-hide-from="xs" class="yk-field-label" field-label="${fieldLabel}">
							${fieldDef.label}
						</td>
						<td style="padding: 0px;">
							<div style="width: ${element.attr('field-width')}; display: inline-block; padding: 0px;">
								<if test="context.fieldDef.fieldType == 'STRING'">
									<input type="text" name="${fieldDef.name}" placeholder="${fieldDef.label}" 
										ng-model="${modelField}" yk-read-only="${fieldDef.readOnly}" ng-change="${validateFunc}"></input>
								</if>
								<else-if test="context.fieldDef.fieldType == 'MULTI_LINE_STRING'">
									<textarea name="${fieldDef.name}" placeholder="${fieldDef.label}" ng-model="${modelField}" 
											yk-read-only="${fieldDef.readOnly}" style="height: 4em;" ng-change="${validateFunc}"></textarea>
								</else-if>
								<else-if test="context.fieldDef.fieldType == 'PASSWORD'">
									<input type="password" name="${fieldDef.name}" placeholder="${fieldDef.label}" ng-model="${modelField}"  
										yk-read-only="${fieldDef.readOnly}" ng-change="${validateFunc}"></input>
								</else-if>
								<else-if test="context.fieldDef.fieldType == 'INTEGER'">
									<input type="number" name="${fieldDef.name}" placeholder="${fieldDef.label}" ng-model="${modelField}"  
										yk-read-only="${fieldDef.readOnly}" ng-change="${validateFunc}"></input>
								</else-if>
								<else-if test="context.fieldDef.fieldType == 'FLOAT' || context.fieldDef.fieldType == 'DOUBLE'">
									<input type="number" name="${fieldDef.name}" placeholder="${fieldDef.label}" ng-model="${modelField}"  
										yk-read-only="${fieldDef.readOnly}" ng-change="${validateFunc}"></input>
								</else-if>
								<else-if test="context.fieldDef.fieldType == 'BOOLEAN'">
									<select name="${fieldDef.name}" ng-model="${modelField}"  yk-read-only="${fieldDef.readOnly}" ng-change="${validateFunc}">
										<option value="" selected=""> -- Select ${fieldDef.label} -- </option>
										<option value="true">True</option>
										<option value="false">False</option>
									</select>
								</else-if>
								<else-if test="context.fieldDef.fieldType == 'DATE'">
									<div class="form-group">
										<div class="model-form-date input-group date" yk-date-format="${modelDef.jsDateFormat}">
											<input type="text" class="form-control"   name="${fieldDef.name}" placeholder="${fieldDef.label}" 
												ng-model="${modelField}" yk-read-only="${fieldDef.readOnly}" ng-change="${validateFunc}"></input>
											<span class="input-group-addon">
												<span class="glyphicon glyphicon-calendar"></span>
											</span>
										</div>
									</div>								
								</else-if>
								<else-if test="context.fieldDef.fieldType == 'LIST_OF_VALUES'">
									<if test="context.extended == 'true'">
										<select name="${fieldDef.name}" ng-model="${modelField}"  yk-read-only="${fieldDef.readOnly}" ng-change="${validateFunc}">
											<option value="" selected=""> -- Select ${fieldDef.label} -- </option>
			
											<for-each data="${fieldDef.lovOptions}" loop-var="lovOption" index-var="idx">
												<option value="${lovOption.value}">${lovOption.label}</option>
											</for-each>
										</select>
									</if>
									<else>
										<yk-lov-field name="${fieldDef.name}" label="${fieldDef.label}" lov="${fieldDef.lovDetails.lovName}" yk-read-only="${fieldDef.readOnly}"
													type="${fieldDef.lovDetails.lovType}" model="${modelField}" on-change="${validateFunc}"></yk-lov-field>
									</else> 
								</else-if>
								<else-if test="context.fieldDef.fieldType == 'FILE'">
									<if test="context.fieldDef.multiValued == false">
										<div style="width: ${attr('width')};padding: 0px;border: solid 1px rgb(200, 200, 200); border-radius: 0.4em;" yk-file="true">
											<table style="width: 100%; table-layout: fixed;">
												<tr>
													<td style="padding: 0.2em; overflow: hidden; white-space: nowrap;">
														<div ng-show="${modelField}">
															<a role="button" yk-file-delete="-1" model-name="${modelField}"
																		data-toggle="tooltip" title="Remove" class="delButtonLink">
																<span aria-hidden="true">&amp;times;</span>
															</a>
															<!-- Span when file info comes from server -->
															<span ng-show="${modelField}.fileName" style="cursor: default;" data-toggle="tooltip" title="{{${modelField}.fileName}}">
																<a href="#" yk-file-link="{{${modelField}.id}}" style="font-weight: bold;"> 
																	{{${modelField}.fileName}}
																</a>
															</span>
															<!-- Span when user adds a file -->
															<span ng-show="${modelField}.name" style="cursor: default;" data-toggle="tooltip" title="{{${modelField}.name}}">
																{{${modelField}.name}}
															</span>
														</div>
														<!-- Span for place holder -->
														<span ng-hide="${modelField}" style="color: rgb(200, 200, 200); margin-left: 0.5em;">
															${fieldDef.label}
														</span>
													</td>
													<td style="width: 2px;padding: 0px;">
														<button type="button" class="btn btn-primary action-button fileProxy" yk-read-only="${fieldDef.readOnly}" style="padding: 0.3em;">...</button>
														<input type="file" name="${fieldDef.name}" ng-model="${modelField}" style="display: none;"></input>										
													</td>
												</tr>
											</table>
										</div>
									</if>
									<else>
										<div style="width: ${attr('width')}; padding: 0px;border: solid 1px rgb(200, 200, 200); border-radius: 0.4em;" yk-file="true">
											<!-- Title bar -->
											<div style="width: 100%;border-bottom: solid 1px rgb(200, 200, 200); padding: 0px; font-size: 0.8em;">
												<table style="width: 100%">
													<tr>
														<td style="text-align: left; color: rgb(200, 200, 200); padding-left: 0.2em;">
															${fieldDef.label}
														</td>
														<td style="text-align: right;">
															<button type="button" class="btn btn-primary action-button fileProxy" 
																yk-read-only="${fieldDef.readOnly}" style="padding: 0.3em; font-size: 0.8em;">...</button>
															<input type="file" name="${fieldDef.name}" ng-model="${modelField}" style="display: none;" multiple="multiple"></input>										
														</td>
													</tr>
												</table>
											</div>
											<!-- File contents -->
											<div style="overflow: auto; height: 4em;">
												<div ng-repeat="file in ${modelField}" style="white-space: nowrap; padding: 0px; margin: 0px; font-size: 0.8em;">
													<a role="button" class="delButtonLink" yk-file-delete="{{$index}}" model-name="${modelField}"  
																data-toggle="tooltip" title="Remove" file-index="{{$index}}">
														<span aria-hidden="true" style="color: red;">&amp;times;</span>
													</a>
													<!-- Span when file info comes from server -->
													<span ng-show="file.fileName" style="cursor: default;" data-toggle="tooltip" title="{{file.fileName}}">
														<a href="#"  yk-file-link="{{file.id}}"  style="font-weight: bold;"> 
															{{file.fileName}}
														</a>
													</span>
													<!-- Span when user adds a file -->
													<span ng-show="file.name" style="cursor: default;" data-toggle="tooltip" title="{{file.name}}">
														{{file.name}}
													</span>
												</div>
											</div>
										</div>
									</else>
								</else-if>
								<else>
									<exe-script var="_tmp1">
										throw "Unsupported field type encountered - " + context.fieldDef.fieldType;
									</exe-script>
								</else>
							</div>
							<div class="yk-field-error" ng-bind="errors.${modelField}">
							</div>
						</td>
					</tr>
				</table>
			</div>
		</content>
	</directive>
	
	<directive name="ykLovField" required-attr="name, label, lov, type">
		<content>
			<exe-script var="_tmp">
				var modelDef = context["$scope"].modelDef;
				var lovName = context.attr('lov');
				var type = context.attr('type');
				var model = context.attr('model');

				if(model &amp;&amp; model.length &gt;= 0)
				{
					context["modelField"] = model; 
				}
				else
				{
					context["modelField"] = context.attr('name');
				}
				
				type = (type == "static" || type == "STATIC_TYPE")? "STATIC_TYPE" : "DYNAMIC_TYPE";
				
				var lovResponse = context.invokeAction('lov.fetch', null, {"name": lovName, "type": type});
				
				if(!lovResponse || !lovResponse.lovList)
				{
					throw "Invalid lov name specified - " + lovName;
				}
	
				var lovList = lovResponse.lovList;
				
				context["lovList"] = lovList;
			</exe-script>
			
			<set-var name="_readOnly" expr="(context.attr('yk-read-only') == 'true') ? 'true' : 'false'"/>
			
			<select name="${attr('name')}"  ng-model="${modelField}" yk-read-only="${_readOnly}" ng-change="${attr('on-change')}">
				<option value="" selected=""> -- Select ${attr('label')} -- </option>
				
				<for-each data="${lovList}" loop-var="lov" index-var="idx">
					<option value="${lov.value}">${lov.label}</option>
				</for-each>
			</select>
		</content>
	</directive>

	<directive name="ykInvoke" required-attr="method">
		<content>
			<exe-script var="_tmp">
				var methodName = context.attr('method');
				context.$scope[methodName]();
			</exe-script>
		</content>
	</directive>

	<attr-directive name="ykHideFrom">
		<script>
			var hideFrom = context.attributeValue;
            var curCssClasses = context.element.attr("class");

            //if no classes are defined
            if (!curCssClasses)
            {
	            curCssClasses = "";
            }

            if (hideFrom == "xs")
            {
	            curCssClasses += " hidden-xs";
            } else if (hideFrom == "sm")
            {
	            curCssClasses += " hidden-xs hidden-sm";
            } else if (hideFrom == "md")
            {
	            curCssClasses += " hidden-xs hidden-sm hidden-md";
            } else
            {
	            console.error("Invalid yk-hide-from value specified - " + hideFrom);
	            return;
            }

            context.element.attr("class", curCssClasses);
		</script>
	</attr-directive>

	<!--
		Adds ng-repeat with same expression as this attribute value. In some cases ng-repeat may get compiled into a comment which 
		may get removed during directive processing. In order to retain ng-repeat this attribute directive can be used  
	 -->
	<attr-directive name="ykRepeat">
		<script>
			var repeatExpr = context.attributeValue;
			context.element.attr("ng-repeat", repeatExpr);
		</script>
	</attr-directive>

	<attr-directive name="ykRepeatStart">
		<script>
			var repeatExpr = context.attributeValue;
			context.element.attr("ng-repeat-start", repeatExpr);
		</script>
	</attr-directive>

	<!-- Adds ng-if attribute. Useful to skip initial processing within other directive -->
	<attr-directive name="ykIf">
		<script>
			var repeatExpr = context.attributeValue;
			context.element.attr("ng-if", repeatExpr);
		</script>
	</attr-directive>

	<attr-directive name="ykClick">
		<script>
			var repeatExpr = context.attributeValue;
			context.element.attr("ng-click", repeatExpr);
		</script>
	</attr-directive>

	<attr-directive name="ykRepeatEnd">
		<script>
			var repeatExpr = context.attributeValue;
			context.element.attr("ng-repeat-end", "");
		</script>
	</attr-directive>

	<attr-directive name="ykShow">
		<script>
			var showExpr = context.attributeValue;
			context.element.attr("ng-show", showExpr);
		</script>
	</attr-directive>

	<attr-directive name="ykBind">
		<script>
			var bindExpr = context.attributeValue;
			context.element.attr("ng-bind", bindExpr);
		</script>
	</attr-directive>

	<!--
		Invokes the date-time-picker data function on target element
		with specified date format value 
	 -->	
	<attr-directive name="ykDateFormat">
		<script>
			var dateFormat = context.attributeValue;
			context.element.datetimepicker({
				"format" : dateFormat
			});
		</script>
	</attr-directive>

	<!--
		Expected to be used as part of file widget. This is used on file's individual remove
		button. And deletes the corresponding file 
	 -->
	<attr-directive name="ykFileDelete">
		<script>
			var fileRemoveButton = context.element;
			var modelName = context.attr('model-name');
			
			$(fileRemoveButton).off("click").on("click", $.proxy(function(event){
				var index = parseInt(this.element.attr("yk-file-delete"));

				//if this button is for single file widget
				if(index &lt; 0)
				{
					eval("this.$scope." + this.modelName + " = null");
					this.$scope.$digest();
				}
				//for multi file widget
				else
				{
					//remove current element
					var files = eval("this.$scope." + this.modelName);
					files.splice(index, 1);
					
					eval("this.$scope." + this.modelName + " = files");
					this.$scope.$parent.$digest();
				}
				
			}, {"element": fileRemoveButton, "$scope" : context.$scope, "modelName": modelName}));
		</script>
	</attr-directive>

	<!-- Used by file widget to display content of the file whose details are obtained from
		server. 
	 -->
	<attr-directive name="ykFileLink">
		<script>
			var fileLink = context.element;
			
			$(fileLink).off("click").on("click", $.proxy(function(event){
				var fileId = parseInt(this.element.attr("yk-file-link"));
				//var fileId = eval("this.$scope." + this.modelName + ".id");
				this.element.get(0).href = this.actionHelper.actionUrl("files.fetch.attachment", {"id": fileId});
			}, {"element": fileLink, "$scope" : context.$scope, "actionHelper": context.actionHelper}));
		</script>
	</attr-directive>

	<attr-directive name="ykFile">
		<script>
			var fileElem = context.element.find("input[type='file']").get(0);
			fileElem = $(fileElem);
			
			//get file proxy button and register event such that when proxy button is clicked
			//		file button click is triggered
			var fileElemProxy = context.element.find("button.fileProxy").get(0);
			$(fileElemProxy).off("click").on("click", $.proxy(function(){
				this.fileElement.trigger("click");
			}, {"fileElement" : fileElem}));
			
			//get name of file element
			var name = fileElem.attr('name');

			//get ng-model name
			var modelName = fileElem.attr("ng-model");
			modelName = (!modelName || modelName.length == 0) ? name : modelName;

			var isMultiple = (fileElem.attr('multiple') == 'multiple');
			
			var eventContent = {
				"$scope" : context.$scope,
				"element": fileElem,
				"modelName": modelName,
				"isMultiple": isMultiple
			};
			
			//add functionality for file link 
			/*
			var fileLink = context.element.find("a.fileLink").get(0);
			
			$(fileLink).off("click").on("click", $.proxy(function(event){
				//var fileId = eval("this.$scope." + this.modelName + ".id");
				//this.element.href = this.actionHelper.actionUrl("files.fetch.attachment", {"id": fileId});
			}, {"element": fileLink, "$scope" : context.$scope, "actionHelper" : context.actionHelper, "modelName": modelName}));
			*/
			
			//add event, such that when file selection is done, the files are added to model
			fileElem.off("change").on('change', $.proxy(function(){
				var fileElem = this.element.get(0);
				var files = fileElem.files;
				
				//if no files are selected return
				if(!files || files.length == 0)
				{
					return;
				}
				
				//if field is expected to hold multiple files, append the new files to the end existing value list
				if(this.isMultiple)
				{
					var currentModelValue = eval("this.$scope." + this.modelName);
					
					if(!currentModelValue)
					{
						currentModelValue = [];
					}
					
					for(var i = 0; i &lt; files.length; i++)
					{
						currentModelValue[currentModelValue.length] = files[i];
					}
					
					eval("this.$scope." + this.modelName + " = currentModelValue");
				}
				//if single file is expected replace current value with new file 
				else
				{
					eval("this.$scope." + this.modelName + " = files[0]");
				}
				
				this.$scope.$digest();
			}, eventContent));
		</script>
	</attr-directive>

	<attr-directive name="ykFileLink">
		<script>
			//get ng-model name
			var modelName = context.attributeValue;

			var fileLink = context.element;
			
			$(fileLink).off("click").on("click", $.proxy(function(){
				var fileId = eval("this.$scope." + this.modelName + ".id");
				this.element.href = this.actionHelper.actionUrl("files.fetch.attachment", {"id": fileId});
			}, {"element": fileLink, "$scope" : context.$scope, "actionHelper" : context.actionHelper, "modelName": modelName}));
		</script>
	</attr-directive>

	<attr-directive name="ykFullHeight">
		<script>
		
			var viewportHeight;
			var viewportWidth;
			
			if (document.compatMode === 'BackCompat') 
			{
			    viewportHeight = document.body.clientHeight;
			    viewportWidth = document.body.clientWidth;
			} 
			else 
			{
			    viewportHeight = document.documentElement.clientHeight;
			    viewportWidth = document.documentElement.clientWidth;
			}
		
		
			var attrVal = context.attributeValue;
			var top = context.element.offset().top;
			var docHeight = 0;
			
			if(attrVal == 'document')
			{
				docHeight = viewportHeight;
			}
			else
			{
				docHeight = $(context.element.parent()).height();
			}
			
			var currentStyle = context.element.attr("style");
			
			if(currentStyle &amp;&amp; currentStyle.length > 0)
			{
				currentStyle += ";";
			}
			else
			{
				currentStyle = "";
			}
			
			context.element.attr("style",  currentStyle + "height : " + (docHeight - top) + "px;");
		</script>
	</attr-directive>


</directives>